# Malware Traffic Analysis 1

1. What is the IP address of the Windows VM that gets infected?  
  `Answer`: 172.16.165.165  
  `Solution`: Use Brim to load the pcap. Search for `event_type="alert"`. 

2. What is the hostname of the Windows VM that gets infected?  
  `Answer`: K34EN6W3N-PC  
  `Solution`: search the answer in number that are DHCP requests. `dhcp 172.16.165.165`  

3. What is the MAC address of the infected VM?  
   `Answer`: f0:19:af:02:9b:f1  
   
4. What is the IP address of the compromised web site?  
   `Answer`: 82.150.140.30  
   `Solution`: Search for dns requests by 172.16.165.165. Similarly, look for HTTP requests by the same IP and you will notice the connection to `www.ciniholand[.]nl`.   

5. What is the FQDN of the compromised website?  
   `Answer`: ciniholland.nl  
   
6. What is the IP address of the server that delivered the exploit kit and malware?  
   `Answer`: 37.200.69.143  
   `Solution`: Use the suricata alerts and look for keywords with *exploit kit*  
   
7. What is the FQDN that delivered the exploit kit and malware?  
   `Answer`: stand.trustandprobaterealty.com  
   `Solution`: search for dns request with the answer in #6 `dns 37.200.69.143`  

8. What is the redirect URL that points to the exploit kit (EK) landing page?  
   `Answer`: http://24corp-shop[.]com/  
   `Solution`: Look for HTTP request to answer in #7. And look for the referrer of that HTTP request.  

9. Other than CVE-2013-2551 IE exploit, another application was targeted by the EK and starts with "J". Provide the full application name.  
   `Answer`: Java  
   `Solution`: Use suricata alerts to find. Another application that was exploited is Flash.  

10. How many times was the payload delivered?  
    `Answer`: 3  

11. The compromised website has a malicious script with a URL. What is this URL?  
    `Answer`:  http://24corp-shop[.]com/  
    `Solution`: open the pcap in wireshark. Look for HTTP requests to the compromised website (ciniholand.nl). Search for any iframe  

12. Extract the two exploit files. What are the MD5 file hashes? (comma-separated )  
    `Answer`:  7b3baa7d6bb3720f369219789e38d6ab,1e34fdebbf655cebea78b45e43520ddf  
    `Solution`: Use the `files` filter in Brim and search for Java and flash files.  
    

    

